Train = read.csv("Train_Imputed_6Vars.csv")
Test = read.csv("Test_Imputed_6Vars.csv")
summary(Train)
varUserId_Train = Train$USER_ID
varUserId_Test = Test$USER_ID
Train$USER_ID = NULL
Test$USER_ID = NULL
library(caTools)
library(rpart.plot)
library(randomForest)
Train <- read.csv("Train_Imputed_6Vars.csv")
str(Train)
varUserId_Train = Train$USER_ID
Train$USER_ID = NULL
library(caTools)
library(rpart.plot)
library(randomForest)
set.seed(13)
splt = sample.split(Train$Party, SplitRatio = 0.70)
set.seed(13)
splt6040 = sample.split(Train$Party, SplitRatio = 0.60)
splt7030 = splt
rm(splt)
table(splt6040)
dfTrain1 = subset(Train, splt7030 == TRUE)
dfTest1 = subset(Train, splt7030 == FALSE)
dfTrain2 = subset(Train, splt6040 == TRUE)
dfTest2 = subset(Train, splt6040 == FALSE)
cartModel1 = rpart(Party ~ ., data = dfTrain1, method = "class")
cartModel2 = rpart(Party ~ ., data = dfTrain2, method = "class")
prp(cartModel1)
prp(cartModel2)
prp(cartModel1)
prp(cartModel2)
prp(cartModel1)
prp(cartModel2)
predCARTM1 <- predict(cartModel1, newdata = dfTest1, type = "class")
predCARTM2 <- predict(cartModel2, newdata = dfTest2, type = "class")
table(dfTrain1$Party, predict(cartModel1, type = "class"))
(1571+830)/norw(Train)
(1571+830)/nrow(Train)
(1571+830)/nrow(dfTrain1)
table(dfTrain2$Party, predict(cartModel2, type = "class"))
(1353+701)/nrow(dfTrain2)
table(dfTest1$Party, predCARTM1)
(685+200)/nrow(dfTest1)
table(dfTest2$Party, predCARTM2)
(903+484)/nrow(dfTest2)
set.seed(13)
splt5050 = sample.split(Train$Party, SplitRatio = 0.50)
dfTrain3 = subset(Train, splt5050 == TRUE)
dfTest3 = subset(Train, splt5050 == FALSE)
cartModel3 <- rpart(Party ~ ., data = dfTrain3, method = "class")
table(dfTrain3$Party, predict(cartModel3, type = "class"))
(942+828)/nrow(dfTrain3)
table(dfTest3$Party, predict(cartModel3, newdata = dfTest3, type = "class"))
(892+799)/nrow(dfTest3)
###########################  TRY-RANDOM_FORREST  ##########################################
?randomForest
rfModel1 <- randomForest(Party ~ ., data = dfTrain1)
rfModel2 <- randomForest(Party ~ ., data = dfTrain2)
rfModel3 <- randomForest(Party ~ ., data = dfTrain3)
table(dfTrain1$Party, predict(rfModel1, type = "class"))
(1397+989)/nrow(dfTrain1)
table(dfTrain2$Party, predict(rfModel2, type = "class"))
(1168+856)/nrow(dfTrain2)
table(dfTrain3$Party, predict(rfModel3, type = "class"))
(967+716) / nrow(dfTrain3)
table(dfTest1$Party, predict(rfModel3, newdata = dfTest1, type = "class"))
(618+453) / nrow(dfTest1)
table(dfTest1$Party, predict(rfModel1, newdata = dfTest1, type = "class"))
(617+456)/norw(dfTest1)
(617+456)/nrow(dfTest1)
table(dfTest2$Party, predict(rfModel2, newdata = dfTest2, type = "class"))
(817+604)/ nrow(dfTest2)
table(dfTest3$Party, predict(rfModel3, newdata = dfTest3, type = "class"))
(1013+755)/norw(dfTest3)
(1013+755)/nrow(dfTest3)
#######################  TRY - GLM MODEL  ################################################
glmModel1 = glm(Party ~ ., data = dfTrain1, family = "binomial")
glmModel2 = glm(Party ~ ., data = dfTrain2, family = "binomial")
glmModel3 = glm(Party ~ ., data = dfTrain3, family = "binomial")
p1 <- predict(glmModel1, type = "response")
tbale(dfTrain1$Party)
table(dfTrain1$Party)
(2064)/(2064+1830)
pa
p1
table(dfTrain1$Party, p1 < 0.5)
table(dfTrain1$Party, p1 > 0.5)
(1456+1180) / nrow(dfTrain1)
table(dfTrain1$Party, predict(glmModel1, type = "response") > 0.5)
table(dfTrain2$Party, predict(glmModel2, type = "response") > 0.5)
(1251+1019)/ nrow(dfTrain2)
table(dfTrain3$Party, predict(glmModel3, type = "response") > 0.5)
(1058+860) / nrow(dfTrain3)
table(dfTest1$Party, predict(glmModel1, newdata = dfTest1, type = "response") > 0.5)
(551+445) / nrow(dfTest1)
table(dfTest2$Party, predict(glmModel2, newdata = dfTest2, type = "response") > 0.5)
(746+618) / nrow(dfTest2)
table(dfTest3$Party, predict(glmModel3, newdata = dfTest3, type = "response") > 0.5)
(912+759) / nrow(dfTest3)
library(ROCR)
predROCR <- prediction(predict(glmModel1, newdata = dfTest1, type = "response"), dfTest1$Party)
perfROCR <- performance(predROCR, "tpr", "fpr")
plot(perfROCR)
as.numeric(performance(predROCR, "auc"))
as.numeric(performance(predROCR, "auc")@y.values)
predROCR <- prediction(predict(glmModel2, newdata = dfTest2, type = "response"), dfTest2$Party)
perfROCR <- performance(predROCR, "tpr", "fpr")
plot(perfROCR)
as.numeric(performance(predROCR, "auc")@y.values)
predROCR <- prediction(predict(glmModel2, newdata = dfTest2, type = "response"), dfTest2$Party)
predROCR <- prediction(predict(glmModel3, newdata = dfTest3, type = "response"), dfTest3$Party)
perfROCR <- performance(predROCR, "tpr", "fpr")
plot(perfROCR)
as.numeric(performance(predROCR, "auc")@y.values)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 55)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 55)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 55)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 55)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 55)
AutoModel(Train, 55)
debugSource('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 55)
AutoModel(Train, 13)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
debugSource('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 13)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 13)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 13)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 13)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 13)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 13)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V1.R')
AutoModel(Train, 13)
(1397+989)/nrow(dfTrain1)
set.seed(13)
splt7525 = sample.split(Train$Party, SplitRatio = 0.75)
dfTrain4 = subset(Train, splt7525 == TRUE)
dfTest4 = subset(Train, splt7525 == FALSE)
cartModel4 <- rpart(Party ~ ., data = dfTrain4, method = "class")
rfModel4 <- randomForest(Party ~ ., data = dfTrain4)
table(dfTrain4$Party, predict(cartModel4, type = "class"))
(1684+885)/nrow(dfTrain4)
table(dfTest4$Party, predict(cartModel4, newdata = dfTest, type = "class"))
table(dfTest4$Party, predict(cartModel4, newdata = dfTest4, type = "class"))
(572+300)/nrow(dfTest4)
predTest <- predict(cartModel4, newdata = Test, type = "class")
PredFile <- data.frame(USER_ID = varUserId_Test, Predictions = as.character(predTest))
View(PredFile)
write.csv(PredFile, "Submission_0609_01.csv", row.names = FALSE)
predTest <- predict(rfModel4, newdata = Test, type = "class")
PredFile <- data.frame(USER_ID = varUserId_Test, Predictions = as.character(predTest))
write.csv(PredFile, "Submission_0609_02.csv", row.names = FALSE)
View(PredFile)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V2.R')
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V2.R')
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V2.R')
AutoModel(Train, 13)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V3.R')
AutoModel(Train, 13)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V3.R')
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V4.R')
AutoModel(Train, 13)
set.seed(13)
splt6535 = sample.split(Train$Party, SplitRatio = 0.65)
dfTrain5 = subset(Train, splt6535 == TRUE)
dfTest5 = subset(Train, splt6535 == FALSE)
glmModel5 <- glm(Party ~ YOB + Gender + Income + HouseholdStatus + EducationLevel + Q123464 + Q123621 + Q116953 + Q115611 + Q115899 + Q114961 + Q114152 + Q109244 + Q100562, data = dfTrain, family = "binomial")
glmModel5 <- glm(Party ~ YOB + Gender + Income + HouseholdStatus + EducationLevel + Q123464 + Q123621 + Q116953 + Q115611 + Q115899 + Q114961 + Q114152 + Q109244 + Q100562, data = dfTrain5, family = "binomial")
table(dfTrain5$Party, predict(glmModel5, type = "response"))
table(dfTrain5$Party, predict(glmModel5, type = "response") > 0.5)
(1248+1004)/nrow(dfTrain5)
table(dfTest5$Party, predict(glmModel5, newdata = dfTest5, type = "response") > 0.5)
(693+552) / nrow(dfTest5)
predTest <- predict(glmModel5, newdata = Test, type = "response")
rm(PredFile)
PredFile = data.frame(USER_ID = varUserId_Test, Predictions = predTest)
write.csv(PredFile, "Submission_0609_06.csv", row.names = FALSE)
predTest1 <- ifelse(predTest < 0.5, "Democrat", "Republican")
PredFile = data.frame(USER_ID = varUserId_Test, Predictions = predTest1)
write.csv(PredFile, "Submission_0609_06.csv", row.names = FALSE)
View(PredFile)
write.csv(PredFile, "Submission_0609_06.csv", row.names = FALSE)
sumamry(glmModel5)
summary(glmModel5)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V5.R')
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V5.R')
AutoModel(Train, 13)
str(Train[1:10])
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V5.R')
AutoModel(Train, 13)
source('~/AnalyticsEdge/Week 7_Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/02_PartImputation_6Vars/AutoModel_V5.R')
AutoModel(Train, 13)
