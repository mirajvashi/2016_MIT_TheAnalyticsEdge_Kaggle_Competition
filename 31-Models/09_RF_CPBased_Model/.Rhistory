Train <- read.csv("../../21-Imputed-Data/Training_Imputed_FULL2.csv")
Test <- read.csv("../../21-Imputed-Data/Test_Imputed_FULL2.csv")
summary(Train)
library(caret)
library(rpart.plot)
library(randomForest)
library(e1071)
library(caTools)
Train1 = subset(Train, (YOB >= 1900 & YOB <= 2003) | is.na(YOB))
summary(Train$YOB)
summary(Train1$YOB)
Trian <- Train1
rm(Train1)
Train <- Trian
rm(Trian)
tr.control = trainControl(method = "cv", number = 10)
cp.grid = expand.grid(.cp = (0:100)*0.001)
tr = train(Party ~ YOB + Income + EducationLevel + Q109244 + HouseholdStatus + Q115611 + Q113181 + Q98197 + Q101163, data = Train, method = "rpart", trControl = tr.control, tuneGrid = cp.grid)
trCART = tr
rm(tr)
trCART
prp(trCART)
prp(trCART$finalModel)
trGLM = train(Party ~ YOB + Income + EducationLevel + Q109244 + HouseholdStatus + Q115611 + Q113181 + Q98197 + Q101163, data = Train, method = "glm", trControl = tr.control, tuneGrid = cp.grid)
trGLM = train(Party ~ YOB + Income + EducationLevel + Q109244 + HouseholdStatus + Q115611 + Q113181 + Q98197 + Q101163, data = Train, method = "glm")
trGLM
trRF = train(Party ~ YOB + Income + EducationLevel + Q109244 + HouseholdStatus + Q115611 + Q113181 + Q98197 + Q101163, data = Train, method = "rf", trControl = tr.control, tuneGrid = cp.grid)
trRF = train(Party ~ YOB + Income + EducationLevel + Q109244 + HouseholdStatus + Q115611 + Q113181 + Q98197 + Q101163, data = Train, method = "rf", mtry = 10)
trRF = train(Party ~ YOB + Income + EducationLevel + Q109244 + HouseholdStatus + Q115611 + Q113181 + Q98197 + Q101163, data = Train, method = "rf", mtry = 5)
trRF = train(Party ~ YOB + Income + EducationLevel + Q109244 + HouseholdStatus + Q115611 + Q113181 + Q98197 + Q101163, data = Train, method = "rf", mtry = 50)
trRF = train(Party ~ YOB + Income + EducationLevel + Q109244 + HouseholdStatus + Q115611 + Q113181 + Q98197 + Q101163, data = Train, method = "rf")
CARTModel = trCART$finalModel
predTest = predict(CARTModel, newdata = Test, type = "class")
summary(Test)
prp(CARTModel)
predict(CARTModel, newdata = Test, type = "class")
