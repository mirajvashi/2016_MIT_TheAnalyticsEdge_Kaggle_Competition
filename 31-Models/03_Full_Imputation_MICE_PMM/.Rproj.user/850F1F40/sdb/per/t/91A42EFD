{
    "contents" : "AutoModel <- function(DF_INPUT, SEED=1)\n{\n###############################################################################################\n## PURPOSE: TEMPLATE R-SCRIPT TO AUTOMATE MODEL BUILDING & ACCURACY CHECK\n## USAGE: CUSTOMIZE EACH SECTION FOR SPECIFIC DATA ANALYSIS NEED\n## TECHNIQUES: GLM, CART & RANDOM FORREST\n###############################################################################################\n\n## LOAD REQUIRED LIBRARIES\nlibrary(caTools)\nlibrary(rpart)\nlibrary(randomForest)\nlibrary(ROCR)\n\n## INITIALIZE VARIABLES\n\nModelTypes = c(\"glm\", \"CART\", \"RandomForest\")\nSplRatio <- c(0.50,0.55,0.60,0.65,0.70,0.75,0.80)\nRandSeed <- ifelse(SEED != 1, SEED, 13)\nThreshold <- c(0.40,0.45,0.50,0.55,0.60)\nTotalRows <- ((length(ModelTypes)-1) * length(SplRatio)) + (length(SplRatio) * length(Threshold))\ndfInput = DF_INPUT\nrIndex = 1\n\n## INITIALIZE OUTPUT DATA FRAME\n\ndfOutput = data.frame(matrix(NA, nrow=TotalRows, ncol=6))\ncolnames(dfOutput) = c(\"Model.Technique\", \"SplitRatio\", \"Threshold\", \"AUC\", \"TrainingSet_Accuracy\", \"TestingSet_Accuracy\")\n\n## BUILD & EVALUATE MODELS\n\nfor (i in 1:length(SplRatio))\n{\n    set.seed(RandSeed)\n    \n    ####: Needs to be customized\n    splt = sample.split(dfInput$Party, SplitRatio = SplRatio[i])\n    dfTrain = subset(dfInput, splt == TRUE)\n    dfTest = subset(dfInput, splt == FALSE)\n    \n    ####: Check for required customization before each run\n    glmModel = glm(Party ~ YOB + Gender + Income + HouseholdStatus + EducationLevel + Q123464 + Q123621 + Q116953 + Q115611 + Q115899 + Q114961 + Q114152 + Q109244 + Q100562 + Q121011 + Q118117 + Q118232 + Q118233 + Q117193 + Q116601 + Q114517 + Q114386 + Q109367 + Q108950 + Q108617 + Q108754 + Q108343 + Q106272 + Q106388 + Q102674 + Q102089 + Q101162, data = dfTrain, family = \"binomial\")\n    cartModel = rpart(Party ~ YOB + Gender + Income + HouseholdStatus + EducationLevel + Q123464 + Q123621 + Q116953 + Q115611 + Q115899 + Q114961 + Q114152 + Q109244 + Q100562 + Q121011 + Q118117 + Q118232 + Q118233 + Q117193 + Q116601 + Q114517 + Q114386 + Q109367 + Q108950 + Q108617 + Q108754 + Q108343 + Q106272 + Q106388 + Q102674 + Q102089 + Q101162, data = dfTrain, method = \"class\")\n    rfModel = randomForest(Party ~ YOB + Gender + Income + HouseholdStatus + EducationLevel + Q123464 + Q123621 + Q116953 + Q115611 + Q115899 + Q114961 + Q114152 + Q109244 + Q100562 + Q121011 + Q118117 + Q118232 + Q118233 + Q117193 + Q116601 + Q114517 + Q114386 + Q109367 + Q108950 + Q108617 + Q108754 + Q108343 + Q106272 + Q106388 + Q102674 + Q102089 + Q101162, data = dfTrain)\n    \n    for(i1 in 1:length(ModelTypes))\n    {\n        if(ModelTypes[i1] == \"glm\")\n        {\n            predTrain = predict(glmModel, type = \"response\")\n            predTest = predict(glmModel, newdata = dfTest, type = \"response\")\n            \n            for(i2 in 1:length(Threshold))\n            {\n                dfOutput[rIndex,1] = ModelTypes[i1]\n                dfOutput[rIndex,2] = SplRatio[i]\n                dfOutput[rIndex,3] = Threshold[i2]\n                ####: Check for required customization before each run\n                dfOutput[rIndex,4] = as.numeric(performance(prediction(predTest, dfTest$Party), \"auc\")@y.values)\n                m = as.matrix(table(dfTrain$Party, predTrain > Threshold[i2]))\n                dfOutput[rIndex,5] = (m[1,1] + m[2,2]) / nrow(dfTrain)\n                m = as.matrix(table(dfTest$Party, predTest > Threshold[i2]))\n                dfOutput[rIndex,6] = (m[1,1] + m[2,2]) / nrow(dfTest)\n                rIndex = rIndex + 1\n            }\n        }\n        \n        if(ModelTypes[i1] == \"CART\")\n        {\n            predTrain = predict(cartModel, type = \"class\")\n            predTest = predict(cartModel, newdata = dfTest, type = \"class\")\n            \n            dfOutput[rIndex,1] = ModelTypes[i1]\n            dfOutput[rIndex,2] = SplRatio[i]\n            dfOutput[rIndex,3] = \"\"\n            dfOutput[rIndex,4] = \"\"\n            ####: Check for required customization before each run\n            m = as.matrix(table(dfTrain$Party, predTrain))\n            dfOutput[rIndex,5] = (m[1,1] + m[2,2]) / nrow(dfTrain)\n            m = as.matrix(table(dfTest$Party, predTest))\n            dfOutput[rIndex,6] = (m[1,1] + m[2,2]) / nrow(dfTest)\n            rIndex = rIndex + 1\n        }\n        \n        if(ModelTypes[i1] == \"RandomForest\")\n        {\n            predTrain = predict(rfModel, type = \"class\")\n            predTest = predict(rfModel, newdata = dfTest, type = \"class\")\n            \n            dfOutput[rIndex,1] = ModelTypes[i1]\n            dfOutput[rIndex,2] = SplRatio[i]\n            dfOutput[rIndex,3] = \"\"\n            dfOutput[rIndex,4] = \"\"\n            ####: Check for required customization before each run\n            m = as.matrix(table(dfTrain$Party, predTrain))\n            dfOutput[rIndex,5] = (m[1,1] + m[2,2]) / nrow(dfTrain)\n            m = as.matrix(table(dfTest$Party, predTest))\n            dfOutput[rIndex,6] = (m[1,1] + m[2,2]) / nrow(dfTest)\n            rIndex = rIndex + 1\n        }\n    }\n}\n## WRITE THE OUTPUT TO CSV FILE: Customeze the name with each version change\n    write.csv(dfOutput, \"AutoModel_V4_Output.csv\", row.names = FALSE)\n}",
    "created" : 1465558167822.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3735025921",
    "id" : "91A42EFD",
    "lastKnownWriteTime" : 1465553641,
    "path" : "D:/11 DATA ANALYTICS/89 MIT_TheAnalyticsEdge/99 Kaggle_Competition/MIT_TheAnalyticsEdge/31-Models/03_Full_Imputation_MICE_PMM/AutoModel_V4.R",
    "project_path" : "AutoModel_V4.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}